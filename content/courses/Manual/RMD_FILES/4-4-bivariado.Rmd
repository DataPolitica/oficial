---
title: "Bivariado"
author: "Christian Chiroque"
date: "29 de agosto de 2020"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Punto de partida

Abrimos la base de datos LAPOP desde nuestro repositorio:

```{r}
library(rio)
link="https://github.com/DataPolitica/salidas/raw/master/Data/sub_lapop.sav"
lapop=import(link)
```

## Paso 0: Verificamos y configuramos adecuadamente las variables que utilizaremos

```{r}
lapop$urbanorural=as.factor(lapop$urbanorural)
levels(lapop$urbanorural)<-c("Urbano","Rural")
lapop$sexo=as.factor(lapop$sexo)
levels(lapop$sexo)<-c("Hombre","Mujer")
```


## 1. Entre dos variables categóricas: urbanorural y sexo

Una vez que hemos identificamos dos variables categóricas lo primeros que podemos solicitar es una tabla de contingencia. 

Ante de seguir te sugiero ver el siguiente tutorial para solicitar tablas de contigencias:

<iframe width="560" height="315" src="https://www.youtube.com/embed/Scual-o95dI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

Como vimos en el video, podemos pedir tablas de contingencia con la función `table()`. Hagamos una tabla para las variables *urbanorural* y *sexo*:

Primero hallemos una tabla de contingencia simple, con sólo las frecuencias. La llamaremos *tabla1*:

```{r}
tabla1 <- table(lapop$urbanorural, lapop$sexo)
tabla1
```

Podemos agregarle los totales marginales escribiendo la siguiente función `addmargins()`

```{r}
addmargins(tabla1)
```


Ahora, pidamos una tabla de contingencia con porcentaje Tenemos que hacer referencia a la tabla creada anteriormente y usar el comando `prop.table()` y lo multiplicamos por 100. La llamaremos *tabla2*:

```{r}
tabla2 <- prop.table(tabla1)*100
tabla2
```

Vemos que nos da los valores totales, pero nosotros queremos sólo los porcentaje por columna. Para ello, debemos hacer referencia a las columnas dentro del comando agregando el número 2 (si ponemos 1 aparecerán los porcentaje por filas)

```{r}
tabla3 <- prop.table(tabla1, 2)*100
tabla3
```

Por último, podemos agregarle los totales marginales escribiendo la siguiente función `addmargins()`

```{r}
addmargins(tabla3)
```


## 2. Entre una variable numérica y otra categórica: edad y urbanorural

- Descriptivos

Para mostrar los descriptivos de una variable numérica según una variable categórica tenemos que considerar a esta última como grupos. De esta manera, lo que hacemos en realidad es la comparación de la numérica entre 2 o más grupos. 

Para ello, utilizamos el paquete `psych()`

```{r}
library(psych)
```

Para describir la varible podemos utilizar la función `describeBy()`. Notemos que primero debemos poner la variable numérica y luego el grupo de comparación. 

Por ejemplo, obtengamos los estadísticos descriptivos de la variable *Edad* según si la persona pertenece al ámbito rural o urbano (categórica/grupos):

```{r}
describeBy(lapop$edad,group=lapop$urbanorural)
```

También podemos solicitar un diagrama de cajas o **boxplot** según los grupos:

```{r}
boxplot(lapop$edad~lapop$urbanorural)
```

## 3. Entre dos variables numéricas: salario actual y salario inicial

Utilicemos la base de datos *trabajadores*: 

```{r}
library(rio)
base_trabajadores="https://github.com/DataPolitica/salidas/raw/master/Data/trabajadores.sav"
trabajadores=import(base_trabajadores)
```

Para analizar la relación entre dos variables numéricas es muy común referirse  al gráfico de dispersión. 

Para ello, solicitamos el gráfico con la función `plot()`. Entre paréntesis colocar las dos variables numéricas: el salario inicial y el salario actual de los trabajadores de una empresa. 

```{r}
plot(trabajadores$salario_actual, trabajadores$salario_inicial)
```

Podemos especificar más elementos de nuestro gráfico de dispersión. Agreguemos título del gráfico y etiquetas de los ejes X e Y:

```{r}
plot(trabajadores$salario_actual, trabajadores$salario_inicial, 
     main="Relación entre salario inicial y salario final", 
     xlab="Salario actual", 
     ylab="Salario final")
```

